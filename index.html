<!doctype html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <title>CollectX MiniApp</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Telegram WebApp SDK -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <!-- –ù–∞—à–∏ —Å—Ç–∏–ª–∏ -->
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div id="app">
      <!-- –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å -->
      <header class="cx-header">
        <div class="cx-logo">CollectX</div>
        <div class="cx-world-name" id="currentWorldName">–í—ã–±–µ—Ä–∏ –º–∏—Ä</div>
      </header>

      <!-- –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—ã–π –≤—ã–±–æ—Ä –º–∏—Ä–æ–≤ -->
      <div class="cx-worlds" id="worldsContainer">
        <!-- –ü–æ–∫–∞ –ø—Ä–æ—Å—Ç–æ –∑–∞–≥–ª—É—à–∫–∏, –ø–æ—Ç–æ–º –ø–æ–¥—Å—Ç–∞–≤–∏–º –∏–∑ backend -->
        <button class="cx-world-pill cx-world-pill--active">Cyber Cats</button>
        <button class="cx-world-pill">Pixel Punks</button>
      </div>

      <!-- –¢–∞–±—ã Home / Market -->
      <div class="cx-tabs">
        <button class="cx-tab cx-tab--active" data-tab="home">Home</button>
        <button class="cx-tab" data-tab="market">Market</button>
      </div>

      <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
      <main class="cx-content" id="content">
        <!-- –ó–¥–µ—Å—å –±—É–¥–µ–º –º–µ–Ω—è—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç –ø–æ –≤–∫–ª–∞–¥–∫–µ -->
      </main>

      <!-- –ù–∏–∂–Ω—è—è –ø–∞–Ω–µ–ª—å / —Å—Ç–∞—Ç—É—Å -->
      <footer class="cx-bottom">
        <span id="userBalance">–ë–∞–ª–∞–Ω—Å: ‚Äî X</span>
      </footer>
    </div>

    <!-- –õ–æ–≥–∏–∫–∞ mini app -->
    <script>
      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp
      const tg = window.Telegram?.WebApp;
      if (tg) {
        tg.ready();
        tg.expand();
      }

      const content = document.getElementById("content");
      const worldNameEl = document.getElementById("currentWorldName");
      const tabs = document.querySelectorAll(".cx-tab");
      const worlds = document.querySelectorAll(".cx-world-pill");

      let currentTab = "home";
      let currentWorld = "Cyber Cats";

      // –°—Ç–∞—Ä—Ç–æ–≤—ã–π —Ä–µ–Ω–¥–µ—Ä
      render();

      // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ç–∞–±–æ–≤
      tabs.forEach((btn) => {
        btn.addEventListener("click", () => {
          tabs.forEach((b) => b.classList.remove("cx-tab--active"));
          btn.classList.add("cx-tab--active");
          currentTab = btn.dataset.tab;
          render();
        });
      });

      // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–∏—Ä–æ–≤ (–ø–æ–∫–∞ –ø—Ä–æ—Å—Ç–æ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é)
      worlds.forEach((btn) => {
        btn.addEventListener("click", () => {
          worlds.forEach((b) => b.classList.remove("cx-world-pill--active"));
          btn.classList.add("cx-world-pill--active");
          currentWorld = btn.textContent.trim();
          worldNameEl.textContent = currentWorld;
          render();
        });
      });

      function render() {
        content.innerHTML = "";

        if (currentTab === "home") {
          renderHome();
        } else if (currentTab === "market") {
          renderMarket();
        }
      }

      function renderHome() {
        const card = document.createElement("div");
        card.className = "cx-card";
        card.innerHTML = `
          <div class="cx-card-title">${currentWorld}</div>
          <div class="cx-card-sub">
            –≠—Ç–æ –∫–∞—Ä–∫–∞—Å —ç–∫—Ä–∞–Ω–∞ Home. –ó–¥–µ—Å—å –ø–æ–∑–∂–µ –±—É–¥—É—Ç –º–∏—Ä, —Å—Ü–µ–Ω–∞, –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –∏ –∫–≤–µ—Å—Ç—ã —ç—Ç–æ–≥–æ –ø–∞–±–ª–∏–∫–∞.
          </div>
        `;
        content.appendChild(card);

        // –ó–∞–≥–ª—É—à–∫–∏ –∫–≤–µ—Å—Ç–æ–≤
        const quests = [
          { title: "–ü–æ–¥–ø–∏—à–∏—Å—å –Ω–∞ –∫–∞–Ω–∞–ª", reward: "+10 XP" },
          { title: "–°–¥–µ–ª–∞–π —Ä–µ–ø–æ—Å—Ç –ø–æ—Å—Ç–∞", reward: "+5 XP" },
          { title: "–ö—É–ø–∏ –ª—é–±–æ–π –ø—Ä–µ–¥–º–µ—Ç –Ω–∞ –º–∞—Ä–∫–µ—Ç–µ", reward: "+20 XP" }
        ];

        quests.forEach((q) => {
          const c = document.createElement("div");
          c.className = "cx-card";
          c.innerHTML = `
            <div class="cx-card-title">${q.title}</div>
            <div class="cx-card-sub">–ù–∞–≥—Ä–∞–¥–∞: ${q.reward}</div>
          `;
          content.appendChild(c);
        });
      }

      function renderMarket() {
        // –ü–æ–∫–∞ –ø—Ä–æ—Å—Ç–æ –º–æ–∫-—Ç–æ–≤–∞—Ä—ã, –ø–æ–∑–∂–µ –ø–æ–¥–º–µ–Ω–∏–º –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ —Å backend
        const items = [
          { name: "Neon Cat #1", rarity: "Rare", price: 50 },
          { name: "Neon Cat #2", rarity: "Epic", price: 120 },
          { name: "Pixel Punk #1", rarity: "Common", price: 20 }
        ];

        items.forEach((item) => {
          const c = document.createElement("div");
          c.className = "cx-card";
          c.innerHTML = `
            <div class="cx-card-title">${item.name}</div>
            <div class="cx-card-sub">${item.rarity} ‚Ä¢ ${item.price} X</div>
          `;
          const btn = document.createElement("button");
          btn.className = "cx-btn-primary";
          btn.textContent = "–ö—É–ø–∏—Ç—å (–∑–∞–≥–ª—É—à–∫–∞)";
          btn.addEventListener("click", () => {
            alert("–ü–æ–∫—É–ø–∫–∞ –ø–æ–∫–∞ —Ñ–µ–π–∫–æ–≤–∞—è. –ü–æ—Ç–æ–º —Ç—É—Ç –±—É–¥–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ backend üôÇ");
          });
          c.appendChild(btn);
          content.appendChild(c);
        });
      }
    </script>
  </body>
</html>
